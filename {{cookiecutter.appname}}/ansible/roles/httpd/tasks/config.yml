---
# 模拟一些配置操作

- name: 创建 httpd 服务相关目录
  file:
    path: "{{ item }}"
    state: directory
  with_items:
    - "{{ www_web_dir }}"
    - "{{ www_web_log_dir }}"

- name: 创建临时目录
  file: dest={{ tmp_dir }} state=directory

- name: 设置 yum 源
  shell: |
    mkdir /etc/yum.repos.d/old_repo
    mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/old_repo/
    curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.crpm.cn/repo/Centos-7-huawei.repo
    yum makecache

- name: 安装 httpd
  yum: name=httpd state=present

- name: 添加 httpd 配置文件
  template: src=static_site_conf.j2 dest=/etc/httpd/conf.d/
  notify: restart httpd
